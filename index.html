<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AetherScript - Документация</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4ElwbwLhBghEWL3d5+8dYkB3ql81n0wCA7OQt56oriTteRU8HA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --bg-color: #f5f5f7;
            --text-color: #1d1d1f;
            --accent-color: #0071e3;
            --card-bg: rgba(255, 255, 255, 0.7);
            --card-blur: blur(10px);
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: var(--card-blur);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 1rem;
            box-shadow: var(--shadow);
        }

        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 2rem;
        }

        nav a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        header {
            text-align: center;
            padding: 4rem 2rem;
            position: relative;
            overflow: hidden;
        }

        header canvas#particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        header h1 {
            font-size: 3rem;
            margin: 0;
            animation: fadeIn 1s ease-out;
        }

        header p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 1rem auto;
            animation: fadeIn 1.5s ease-out;
        }

        section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .docs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .doc-card {
            background: var(--card-bg);
            backdrop-filter: var(--card-blur);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            animation: slideUp 0.5s ease-out;
        }

        .doc-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .doc-card h3 {
            margin-top: 0;
            color: var(--accent-color);
        }

        .doc-card pre {
            background: rgba(0, 0, 0, 0.05);
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
        }

        .doc-card button {
            background: var(--accent-color);
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .doc-card button:hover {
            transform: scale(1.05);
        }

        .sandbox {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .sandbox textarea {
            width: 100%;
            max-width: 500px;
            height: 300px;
            background: var(--card-bg);
            backdrop-filter: var(--card-blur);
            border: none;
            border-radius: 10px;
            padding: 1rem;
            font-family: monospace;
            box-shadow: var(--shadow);
            resize: vertical;
        }

        .sandbox #preview {
            flex: 1;
            background: #fff;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: var(--shadow);
            min-height: 300px;
        }

        .sandbox button {
            background: var(--accent-color);
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .sandbox button:hover {
            transform: scale(1.05);
        }

        footer {
            text-align: center;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: var(--card-blur);
            box-shadow: var(--shadow);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            nav ul { flex-direction: column; align-items: center; }
            header h1 { font-size: 2rem; }
            .sandbox { flex-direction: column; }
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="#home">Главная</a></li>
            <li><a href="#docs">Документация</a></li>
            <li><a href="#sandbox">Песочница</a></li>
            <li><a href="#about">О проекте</a></li>
        </ul>
    </nav>

    <header id="home">
        <canvas id="particles"></canvas>
        <h1>AetherScript</h1>
        <p>Простой и мощный язык программирования для начинающих и профессионалов.</p>
    </header>

    <section id="docs">
        <h2>Документация</h2>
        <div class="docs-grid">
            <div class="doc-card">
                <h3>let</h3>
                <p>Объявляет переменную.</p>
                <pre><code class="language-aetherscript">let x = 42;</code></pre>
                <button onclick="tryCode('let x = 42;\nprint(x);')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>print</h3>
                <p>Выводит значение в консоль.</p>
                <pre><code class="language-aetherscript">print("Привет, мир!");</code></pre>
                <button onclick="tryCode('print(\"Привет, мир!\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>if / else</h3>
                <p>Условный оператор.</p>
                <pre><code class="language-aetherscript">if x > 10 {
    print("x больше 10");
} else {
    print("x меньше или равно 10");
}</code></pre>
                <button onclick="tryCode('let x = 15;\nif x > 10 {\n    print(\"x больше 10\");\n} else {\n    print(\"x меньше или равно 10\");\n}')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>input</h3>
                <p>Запрашивает ввод пользователя.</p>
                <pre><code class="language-aetherscript">input("Введите число: ");</code></pre>
                <button onclick="tryCode('input(\"Введите число: \");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>createElement</h3>
                <p>Создаёт HTML-элемент с указанным ID.</p>
                <pre><code class="language-aetherscript">createElement("div", "myDiv");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"myDiv\");\nappendChild(\"app\", \"myDiv\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>setText</h3>
                <p>Устанавливает текст для элемента.</p>
                <pre><code class="language-aetherscript">setText("myDiv", "Привет!");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"myDiv\");\nsetText(\"myDiv\", \"Привет!\");\nappendChild(\"app\", \"myDiv\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>setStyle</h3>
                <p>Устанавливает CSS-свойство для элемента.</p>
                <pre><code class="language-aetherscript">setStyle("myDiv", "background", "#f0f0f0");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"myDiv\");\nsetStyle(\"myDiv\", \"background\", \"#f0f0f0\");\nappendChild(\"app\", \"myDiv\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>addEvent</h3>
                <p>Добавляет обработчик событий.</p>
                <pre><code class="language-aetherscript">addEvent("btn", "click", "print('Нажато!');");</code></pre>
                <button onclick="tryCode('createElement(\"button\", \"btn\");\nsetText(\"btn\", \"Нажми\");\naddEvent(\"btn\", \"click\", \"print(\\\'Нажато!\\\');\");\nappendChild(\"app\", \"btn\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>appendChild</h3>
                <p>Добавляет дочерний элемент в родительский.</p>
                <pre><code class="language-aetherscript">appendChild("app", "myDiv");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"myDiv\");\nappendChild(\"app\", \"myDiv\");')">Попробовать</button>
            </div>
        </div>
        <h3>Примеры веб-приложений</h3>
        <div class="docs-grid">
            <div class="doc-card">
                <h3>Счётчик</h3>
                <p>Простой счётчик с кнопкой.</p>
                <pre><code class="language-aetherscript">createElement("div", "container");
setStyle("container", "padding", "20px");
createElement("button", "btn");
setText("btn", "Нажми меня");
setStyle("btn", "background", "#0071e3");
setStyle("btn", "color", "#fff");
appendChild("container", "btn");
addEvent("btn", "click", "print('Кнопка нажата!');");
appendChild("app", "container");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"container\");\nsetStyle(\"container\", \"padding\", \"20px\");\ncreateElement(\"button\", \"btn\");\nsetText(\"btn\", \"Нажми меня\");\nsetStyle(\"btn\", \"background\", \"#0071e3\");\nsetStyle(\"btn\", \"color\", \"#fff\");\nappendChild(\"container\", \"btn\");\naddEvent(\"btn\", \"click\", \"print(\\\'Кнопка нажата!\\\');\");\nappendChild(\"app\", \"container\");')">Попробовать</button>
            </div>
            <div class="doc-card">
                <h3>Todo-лист</h3>
                <p>Список задач с вводом.</p>
                <pre><code class="language-aetherscript">createElement("div", "container");
setStyle("container", "padding", "20px");
createElement("input", "taskInput");
setStyle("taskInput", "marginRight", "10px");
createElement("button", "addBtn");
setText("addBtn", "Добавить");
setStyle("addBtn", "background", "#0071e3");
setStyle("addBtn", "color", "#fff");
createElement("ul", "taskList");
appendChild("container", "taskInput");
appendChild("container", "addBtn");
appendChild("container", "taskList");
addEvent("addBtn", "click", "print('Задача добавлена!');");
appendChild("app", "container");</code></pre>
                <button onclick="tryCode('createElement(\"div\", \"container\");\nsetStyle(\"container\", \"padding\", \"20px\");\ncreateElement(\"input\", \"taskInput\");\nsetStyle(\"taskInput\", \"marginRight\", \"10px\");\ncreateElement(\"button\", \"addBtn\");\nsetText(\"addBtn\", \"Добавить\");\nsetStyle(\"addBtn\", \"background\", \"#0071e3\");\nsetStyle(\"addBtn\", \"color\", \"#fff\");\ncreateElement(\"ul\", \"taskList\");\nappendChild(\"container\", \"taskInput\");\nappendChild(\"container\", \"addBtn\");\nappendChild(\"container\", \"taskList\");\naddEvent(\"addBtn\", \"click\", \"print(\\\'Задача добавлена!\\\');\");\nappendChild(\"app\", \"container\");')">Попробовать</button>
            </div>
        </div>
    </section>

    <section id="sandbox">
        <h2>Песочница</h2>
        <div class="sandbox">
            <div>
                <textarea id="code" placeholder="Введите код AetherScript..."></textarea>
                <button onclick="runCode()">Запустить</button>
                <button onclick="exportHtml()">Экспорт HTML</button>
            </div>
            <div id="preview"></div>
        </div>
    </section>

    <section id="about">
        <h2>О проекте</h2>
        <p>AetherScript — это язык программирования, созданный для упрощения обучения программированию. Поддерживает веб-разработку через DOM.</p>
        <p>© 2025 Nicet Software. Лицензия NSPL 1.0</p>
    </section>

    <footer>
        <p>GitHub: <a href="https://github.com/Nicetink/AetherScript">AetherScript</a></p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXgA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Частицы для логотипа
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = 400;
        const particles = [];
        for (let i = 0; i < 50; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 3 + 1,
                vx: Math.random() * 2 - 1,
                vy: Math.random() * 2 - 1
            });
        }
        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.x += p.vx;
                p.y += p.vy;
                if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(0, 113, 227, 0.5)';
                ctx.fill();
            });
            requestAnimationFrame(animateParticles);
        }
        animateParticles();

        // Интерпретатор AetherScript
        class AetherScriptInterpreter {
            constructor() {
                this.variables = {};
                this.jsBuffer = [];
            }

            evaluateExpression(expr) {
                expr = expr.trim();
                try {
                    if (/^\d+(\.\d+)?$/.test(expr)) return parseFloat(expr);
                    if (expr.startsWith('"') && expr.endsWith('"')) return expr.slice(1, -1);
                    if (expr in this.variables) return this.variables[expr];
                    expr = expr.replace(/\s/g, '');
                    if (expr.includes('+')) {
                        let [left, right] = expr.split('+', 2);
                        return this.evaluateExpression(left) + this.evaluateExpression(right);
                    }
                    if (expr.includes('-')) {
                        let [left, right] = expr.split('-', 2);
                        return this.evaluateExpression(left) - this.evaluateExpression(right);
                    }
                    if (expr.includes('*')) {
                        let [left, right] = expr.split('*', 2);
                        return this.evaluateExpression(left) * this.evaluateExpression(right);
                    }
                    if (expr.includes('/')) {
                        let [left, right] = expr.split('/', 2);
                        return this.evaluateExpression(left) / this.evaluateExpression(right);
                    }
                    throw new Error(`Некорректное выражение: ${expr}`);
                } catch (e) {
                    console.error(`Ошибка в evaluateExpression: ${expr}, ${e}`);
                    throw new Error(`Некорректное выражение: ${expr}`);
                }
            }

            execute(code) {
                this.jsBuffer = [];
                const output = [];
                const errors = [];
                const lines = code.split('\n');
                let i = 0;
                while (i < lines.length) {
                    let line = lines[i].trim();
                    if (!line || line.startsWith('//')) {
                        i++;
                        continue;
                    }
                    try {
                        if (line.startsWith('let ')) {
                            const match = line.match(/let (\w+) = (.+);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректное объявление переменной: ${line}`);
                                return errors;
                            }
                            const [, varName, expr] = match;
                            this.variables[varName] = this.evaluateExpression(expr);
                            i++;
                            continue;
                        }
                        if (line.startsWith('print(')) {
                            const match = line.match(/print\((.+)\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда print: ${line}`);
                                return errors;
                            }
                            const value = this.evaluateExpression(match[1]);
                            output.push(String(value));
                            i++;
                            continue;
                        }
                        if (line.startsWith('input(')) {
                            const match = line.match(/input\("([^"]*)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда input: ${line}`);
                                return errors;
                            }
                            const prompt = match[1];
                            const userInput = "42";
                            output.push(`${prompt}${userInput}`);
                            this.variables['input_result'] = userInput;
                            i++;
                            continue;
                        }
                        if (line.startsWith('if ')) {
                            const match = line.match(/if (.+) \{/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда if: ${line}`);
                                return errors;
                            }
                            const condition = match[1];
                            const condValue = this.evaluateExpression(condition);
                            const blockLines = [];
                            i++;
                            while (i < lines.length && lines[i].trim() !== '}') {
                                blockLines.push(lines[i]);
                                i++;
                            }
                            if (i >= lines.length) {
                                errors.push(`Ошибка: Незакрытый блок if`);
                                return errors;
                            }
                            i++;
                            const elseBlock = [];
                            if (i < lines.length && lines[i].trim().startsWith('else')) {
                                i++;
                                while (i < lines.length && lines[i].trim() !== '}') {
                                    elseBlock.push(lines[i]);
                                    i++;
                                }
                                if (i >= lines.length) {
                                    errors.push(`Ошибка: Незакрытый блок else`);
                                    return errors;
                                }
                                i++;
                            }
                            if (condValue) {
                                output.push(...this.execute(blockLines.join('\n')));
                            } else if (elseBlock.length) {
                                output.push(...this.execute(elseBlock.join('\n')));
                            }
                            continue;
                        }
                        if (line.startsWith('createElement(')) {
                            const match = line.match(/createElement\("([^"]+)","([^"]+)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда createElement: ${line}`);
                                return errors;
                            }
                            const [, elemType, elemId] = match;
                            this.jsBuffer.push(`document.createElement('${elemType}').id = '${elemId}';`);
                            i++;
                            continue;
                        }
                        if (line.startsWith('setText(')) {
                            const match = line.match(/setText\("([^"]+)","([^"]+)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда setText: ${line}`);
                                return errors;
                            }
                            const [, elemId, text] = match;
                            this.jsBuffer.push(`document.getElementById('${elemId}').textContent = '${text}';`);
                            i++;
                            continue;
                        }
                        if (line.startsWith('setStyle(')) {
                            const match = line.match(/setStyle\("([^"]+)","([^"]+)","([^"]+)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда setStyle: ${line}`);
                                return errors;
                            }
                            const [, elemId, prop, value] = match;
                            this.jsBuffer.push(`document.getElementById('${elemId}').style.${prop} = '${value}';`);
                            i++;
                            continue;
                        }
                        if (line.startsWith('appendChild(')) {
                            const match = line.match(/appendChild\("([^"]+)","([^"]+)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда appendChild: ${line}`);
                                return errors;
                            }
                            const [, parentId, childId] = match;
                            this.jsBuffer.push(`document.getElementById('${parentId}').appendChild(document.getElementById('${childId}'));`);
                            i++;
                            continue;
                        }
                        if (line.startsWith('addEvent(')) {
                            const match = line.match(/addEvent\("([^"]+)","([^"]+)","([^"]+)"\);/);
                            if (!match) {
                                errors.push(`Ошибка: Некорректная команда addEvent: ${line}`);
                                return errors;
                            }
                            const [, elemId, event, code] = match;
                            const jsCode = this.convertToJs(code);
                            this.jsBuffer.push(`document.getElementById('${elemId}').addEventListener('${event}', () => {${jsCode}});`);
                            i++;
                            continue;
                        }
                        errors.push(`Ошибка: Неизвестная команда: ${line}`);
                        return errors;
                    } catch (e) {
                        console.error(`Ошибка на строке ${i + 1}: ${line}, ${e}`);
                        errors.push(`Ошибка выполнения: ${e.message}`);
                        return errors;
                    }
                }
                return output.length ? output : ["Нет вывода"];
            }

            convertToJs(code) {
                const lines = code.split(';').map(line => line.trim()).filter(line => line);
                const jsCode = [];
                for (const line of lines) {
                    if (line.startsWith('print(')) {
                        const match = line.match(/print\((.+)\)/);
                        if (match) {
                            const value = this.evaluateExpression(match[1]);
                            jsCode.push(`console.log('${value}');`);
                        }
                    } else if (line.startsWith('let ')) {
                        const match = line.match(/let (\w+) = (.+)/);
                        if (match) {
                            const [, varName, expr] = match;
                            const value = this.evaluateExpression(expr);
                            jsCode.push(`let ${varName} = ${JSON.stringify(value)};`);
                        }
                    }
                }
                return jsCode.join('\n');
            }

            getJsCode() {
                return this.jsBuffer.join('\n');
            }
        }

        const interpreter = new AetherScriptInterpreter();

        function tryCode(code) {
            document.getElementById('code').value = code;
            runCode();
        }

        function runCode() {
            const code = document.getElementById('code').value;
            const preview = document.getElementById('preview');
            preview.innerHTML = '';
            const result = interpreter.execute(code);
            if (result[0].startsWith('Ошибка:')) {
                preview.innerHTML = `<p style="color: red;">${result.join('<br>')}</p>`;
            } else {
                console.log(result);
                const jsCode = interpreter.getJsCode();
                const script = document.createElement('script');
                script.textContent = jsCode;
                preview.appendChild(script);
            }
        }

        function exportHtml() {
            const jsCode = interpreter.getJsCode();
            const html = `
            <html>
            <head>
                <title>AetherScript App</title>
                <style>
                    body { font-family: system-ui; background: #f5f5f7; padding: 20px; }
                    #app { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
                    button { padding: 10px 20px; background: #0071e3; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: transform 0.3s; }
                    button:hover { transform: scale(1.05); }
                </style>
            </head>
            <body>
                <div id="app"></div>
                <script>
                    ${jsCode}
                </script>
            </body>
            </html>`;
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'aetherscript_app.html';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
